(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[590],{1775:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(7653);/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=(...e)=>e.filter((e,t,n)=>!!e&&n.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.446.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:s,className:o="",children:i,iconNode:c,...d},x)=>(0,r.createElement)("svg",{ref:x,...a,width:t,height:t,stroke:e,strokeWidth:s?24*Number(n)/Number(t):n,className:l("lucide",o),...d},[...c.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(i)?i:[i]])),i=((e,t)=>{let n=(0,r.forwardRef)(({className:n,...a},i)=>(0,r.createElement)(o,{ref:i,iconNode:t,className:l(`lucide-${s(e)}`,n),...a}));return n.displayName=`${e}`,n})("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},8030:function(e,t,n){Promise.resolve().then(n.bind(n,6837))},6837:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return m}});var r=n(7573),s=n(7653),l=n(2056),a=n.n(l),o=n(1775),i=n(9811);let c=[{id:"version",title:"Версия",description:"Идентификатор версии формата отчёта.",promptTemplate:'Укажи версию формата отчёта (например, "1.0"). Это техническое поле для совместимости.',getInputPreview:()=>({note:"Версия формата генерируется автоматически."}),getBlockText:e=>null==e?void 0:e.version},{id:"sprint",title:"Информация о спринте",description:"Название спринта и ключевые даты.",promptTemplate:'Сформируй краткую строку с названием спринта и датами в формате: "Sprint Name (DD.MM - DD.MM.YYYY)".',getInputPreview:e=>({sprint:null==e?void 0:e.sprint}),getBlockText:e=>null==e?void 0:e.sprint},{id:"overview",title:"Обзор спринта",description:"Обзор завершённого спринта (5–10 предложений).",promptTemplate:"Сгенерируй обзор спринта (5–10 предложений) на основе цели спринта, списка задач и их статусов. Пиши по-деловому, понятно для внешнего партнёра. Не упоминай внутренние детали, фокусируйся на результатах.",getInputPreview:e=>{var t,n;return{sprint:null==e?void 0:e.sprint,dataValidation:{goalIssueMatchLevel:null==e?void 0:null===(t=e.dataValidation)||void 0===t?void 0:t.goalIssueMatchLevel,goalIssueMatchComment:null==e?void 0:null===(n=e.dataValidation)||void 0===n?void 0:n.goalIssueMatchComment}}},getBlockText:e=>null==e?void 0:e.overview},{id:"notDone",title:"Не выполнено",description:"Список задач, которые не были завершены в спринте.",promptTemplate:"Составь список незавершённых задач спринта. Для каждой укажи название и краткую причину (если известна). Формат: маркированный список.",getInputPreview:e=>({sprint:null==e?void 0:e.sprint,note:"Список незавершённых задач берётся из данных Jira."}),getBlockText:e=>null==e?void 0:e.notDone},{id:"achievements",title:"Достижения",description:"Ключевые достижения и завершённые задачи спринта.",promptTemplate:"Опиши ключевые достижения спринта: завершённые фичи, важные исправления, улучшения. Пиши конкретно, с акцентом на бизнес-ценность для партнёра.",getInputPreview:e=>({sprint:null==e?void 0:e.sprint,note:"Данные о завершённых задачах берутся из Jira."}),getBlockText:e=>null==e?void 0:e.achievements},{id:"artifacts",title:"Артефакты",description:"Ссылки на документы, релизы, демо и другие материалы.",promptTemplate:'Перечисли артефакты спринта: ссылки на документацию, релизы, демо-видео, дизайн-макеты. Если артефактов нет — укажи "Нет артефактов".',getInputPreview:e=>({sprint:null==e?void 0:e.sprint,note:"Артефакты могут быть указаны в описании задач или в extra-параметрах."}),getBlockText:e=>null==e?void 0:e.artifacts},{id:"nextSprint",title:"Следующий спринт",description:"Планы и приоритеты на следующий спринт.",promptTemplate:'Опиши планы на следующий спринт: основные приоритеты, ожидаемые фичи, технический долг. Если информации нет — укажи "Планы уточняются".',getInputPreview:e=>({sprint:null==e?void 0:e.sprint,note:"Планы на следующий спринт могут быть в extra-параметрах или в бэклоге."}),getBlockText:e=>null==e?void 0:e.nextSprint},{id:"blockers",title:"Блокеры",description:"Проблемы и блокеры, влияющие на прогресс.",promptTemplate:'Перечисли блокеры и проблемы спринта: технические сложности, зависимости от внешних команд, нехватка ресурсов. Если блокеров не было — укажи "Блокеров не выявлено".',getInputPreview:e=>{var t,n;return{sprint:null==e?void 0:e.sprint,dataValidation:{errors:null==e?void 0:null===(t=e.dataValidation)||void 0===t?void 0:t.errors,warnings:null==e?void 0:null===(n=e.dataValidation)||void 0===n?void 0:n.warnings}}},getBlockText:e=>null==e?void 0:e.blockers},{id:"pmQuestions",title:"Вопросы к PM",description:"Вопросы и уточнения, требующие внимания PM.",promptTemplate:'Сформулируй вопросы к проектному менеджеру: уточнения по требованиям, приоритетам, срокам. Если вопросов нет — укажи "Вопросов нет".',getInputPreview:e=>{var t;return{sprint:null==e?void 0:e.sprint,dataValidation:{warnings:null==e?void 0:null===(t=e.dataValidation)||void 0===t?void 0:t.warnings}}},getBlockText:e=>null==e?void 0:e.pmQuestions}];var d=n(3613);function x(e){let{title:t,children:n,defaultOpen:l=!1}=e,[a,i]=(0,s.useState)(l);return(0,r.jsxs)("div",{className:"border border-green-500 mb-4",children:[(0,r.jsxs)("button",{onClick:()=>i(!a),className:"w-full px-4 py-3 flex items-center justify-between bg-black text-green-500 hover:bg-green-950 transition-colors font-mono",children:[(0,r.jsx)("span",{className:"text-left",children:t}),(0,r.jsx)(o.Z,{className:"w-4 h-4 transition-transform ".concat(a?"rotate-90":"")})]}),a&&(0,r.jsx)("div",{className:"px-4 py-3 bg-black text-green-500 border-t border-green-500",children:n})]})}function m(){let[e,t]=(0,s.useState)(null),[n,l]=(0,s.useState)(null),[x,m]=(0,s.useState)(!1),[p,h]=(0,s.useState)(null),[g,v]=(0,s.useState)(null),[f,b]=(0,s.useState)(!1),[N,j]=(0,s.useState)(!1),[w,k]=(0,s.useState)(""),[y,S]=(0,s.useState)(""),[C,T]=(0,s.useState)(""),[E,I]=(0,s.useState)(!1),[P,O]=(0,s.useState)(""),[R,B]=(0,s.useState)(""),[L,D]=(0,s.useState)(!1),A=()=>{let e={mockMode:E};if(w.trim()&&(e.sprintId=w.trim()),y.trim()&&(e.sprintName=y.trim()),C.trim()&&(e.boardId=C.trim()),P.trim())try{let t=JSON.parse(P);e.extra=t,B("")}catch(e){return B("Parse error: invalid JSON"),null}return e},U=async()=>{let e=A();if(e){m(!0),h("collect"),v(null);try{let n=await (0,i.j)("collect",e);t(n)}catch(t){let e=t instanceof Error?t.message:"Unknown error occurred";v(e),console.error("Collect step failed:",t)}finally{m(!1),h(null)}}},M=async()=>{let e=A();if(e){m(!0),h("generate"),v(null);try{let t=await (0,i.j)("generate",e);l(t)}catch(t){let e=t instanceof Error?t.message:"Unknown error occurred";v(e),console.error("Generate step failed:",t)}finally{m(!1),h(null)}}},_=async()=>{await M()},G=(null==n?void 0:n.result)||(null==e?void 0:e.result),J=n||e;return(0,r.jsx)("div",{className:"min-h-screen bg-black p-4 md:p-8",children:(0,r.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,r.jsxs)("div",{className:"mb-8 border-b border-green-500 pb-4",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,r.jsx)(a(),{href:"/",className:"text-green-500 font-mono text-sm hover:text-green-300 transition-colors",children:"[HOME]"}),(0,r.jsx)("span",{className:"text-green-500/50",children:"/"}),(0,r.jsx)("span",{className:"text-green-500 font-mono text-sm",children:"Stage 2"})]}),(0,r.jsx)(d.U,{level:1,className:"mb-2",children:"[STAGE 2] Генерация отчёта по блокам"}),(0,r.jsx)("p",{className:"text-green-500 font-mono text-sm opacity-80",children:"Пошаговая генерация каждого блока отчёта с просмотром промптов и входных данных"})]}),g&&(0,r.jsx)("div",{className:"mb-6 border border-red-500 bg-black p-4",children:(0,r.jsxs)("div",{className:"text-red-500 font-mono text-sm",children:["[ERROR] ",g]})}),(0,r.jsxs)(d.jB,{className:"mb-8",children:[(0,r.jsx)(d.U,{level:2,className:"mb-4",children:"[ ПАРАМЕТРЫ ]"}),(0,r.jsx)(d.tS,{}),(0,r.jsxs)("div",{className:"space-y-4 mb-6",children:[(0,r.jsx)(d.xj,{label:"Sprint ID:",value:w,onChange:k,disabled:x,placeholder:"e.g., 12345"}),(0,r.jsx)(d.xj,{label:"Sprint Name:",value:y,onChange:S,disabled:x,placeholder:"e.g., Sprint 42"}),(0,r.jsx)(d.xj,{label:"Board ID:",value:C,onChange:T,disabled:x,placeholder:"e.g., board-123"}),(0,r.jsx)(d.fm,{label:"MOCK_MODE",checked:E,onChange:I,disabled:x}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("button",{onClick:()=>D(!L),disabled:x,className:"flex items-center text-green-500 font-mono text-sm hover:text-green-300 transition-colors disabled:opacity-50",children:[(0,r.jsx)(o.Z,{className:"w-4 h-4 mr-1 transition-transform ".concat(L?"rotate-90":"")}),"Extra JSON params"]}),L&&(0,r.jsxs)("div",{className:"mt-2",children:[(0,r.jsx)(d.xj,{label:"",value:P,onChange:O,disabled:x,placeholder:'{"key": "value"}',type:"textarea"}),R&&(0,r.jsx)("div",{className:"text-red-500 font-mono text-xs mt-1",children:R})]})]})]}),x&&(0,r.jsx)("div",{className:"mb-4 text-green-500 font-mono text-sm animate-pulse",children:"collect"===p?"[ RUNNING STEP 1 (COLLECT)... ]":"[ RUNNING GENERATE... ]"}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,r.jsx)(d.RD,{onClick:U,disabled:x,variant:"secondary",children:"[RUN STEP 1 FIRST]"}),(0,r.jsx)(d.RD,{onClick:M,disabled:x,children:"[RUN GENERATION FOR ALL BLOCKS]"})]})]}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)(d.U,{level:2,className:"mb-4",children:"[ БЛОКИ ОТЧЁТА ]"}),(0,r.jsx)("div",{className:"space-y-4",children:c.map(e=>(0,r.jsx)(u,{block:e,result:G,onGo:_,isRunning:x},e.id))})]}),(0,r.jsxs)(d.jB,{children:[(0,r.jsx)(d.U,{level:2,className:"mb-4",children:"[ ОТЛАДКА ]"}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsxs)("button",{onClick:()=>j(!N),className:"flex items-center text-green-500 font-mono text-sm hover:text-green-300 transition-colors",children:[(0,r.jsx)(o.Z,{className:"w-4 h-4 mr-1 transition-transform ".concat(N?"rotate-90":"")}),"Logs"]}),N&&(null==J?void 0:J.logs)&&J.logs.length>0&&(0,r.jsx)("div",{className:"mt-2 border border-green-500/50 p-4 max-h-60 overflow-auto",children:(0,r.jsx)("div",{className:"space-y-1",children:J.logs.map((e,t)=>(0,r.jsx)("div",{className:"font-mono text-xs text-green-500",children:e},t))})}),N&&(!(null==J?void 0:J.logs)||0===J.logs.length)&&(0,r.jsx)("div",{className:"mt-2 text-green-500/50 font-mono text-sm",children:"[ No logs ]"})]}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("button",{onClick:()=>b(!f),className:"flex items-center text-green-500 font-mono text-sm hover:text-green-300 transition-colors",children:[(0,r.jsx)(o.Z,{className:"w-4 h-4 mr-1 transition-transform ".concat(f?"rotate-90":"")}),"Raw JSON"]}),f&&J&&(0,r.jsx)("div",{className:"mt-2 border border-green-500/50 p-4 overflow-auto max-h-96",children:(0,r.jsx)("pre",{className:"font-mono text-xs text-green-500",children:JSON.stringify(J,null,2)})}),f&&!J&&(0,r.jsx)("div",{className:"mt-2 text-green-500/50 font-mono text-sm",children:"[ No data ]"})]})]}),(null==G?void 0:G.report)&&(0,r.jsx)("div",{className:"mt-8 text-center",children:(0,r.jsx)(a(),{href:"/stage-3",className:"inline-block border border-green-500 text-green-500 px-6 py-3 font-mono hover:bg-green-500 hover:text-black transition-colors",children:"[NEXT] Перейти к Stage 3 — Финальная валидация →"})})]})})}function u(e){var t;let{block:n,result:s,onGo:l,isRunning:a}=e,o=n.getInputPreview(null!=s?s:null),i=n.getBlockText(null!==(t=null==s?void 0:s.report)&&void 0!==t?t:null);return(0,r.jsx)(x,{title:"[BLOCK] ".concat(n.title),children:(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsx)("div",{className:"text-green-500/70 font-mono text-sm",children:n.description}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-green-400 font-mono text-xs mb-1",children:"PROMPT:"}),(0,r.jsx)("pre",{className:"font-mono text-xs text-green-500 bg-green-950/30 p-3 rounded whitespace-pre-wrap border border-green-500/30",children:n.promptTemplate})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-green-400 font-mono text-xs mb-1",children:"INPUT DATA (preview):"}),(0,r.jsx)("pre",{className:"font-mono text-xs text-green-500 bg-green-950/30 p-3 rounded whitespace-pre-wrap border border-green-500/30 max-h-40 overflow-auto",children:JSON.stringify(o,null,2)})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("div",{className:"text-green-400 font-mono text-xs mb-1",children:"RESULT:"}),(0,r.jsx)("pre",{className:"font-mono text-xs text-green-500 bg-green-950/30 p-3 rounded whitespace-pre-wrap border border-green-500/30 max-h-60 overflow-auto",children:i||"<no data yet>"})]}),(0,r.jsx)("div",{className:"pt-2",children:(0,r.jsx)(d.RD,{onClick:l,disabled:a,variant:"secondary",className:"text-sm px-3 py-2",children:"[Go] Сгенерировать"})})]})})}},3613:function(e,t,n){"use strict";n.d(t,{tS:function(){return x},RD:function(){return a},fm:function(){return i},U:function(){return l},xj:function(){return o},jB:function(){return s}});var r=n(7573);function s(e){let{children:t,className:n=""}=e;return(0,r.jsx)("div",{className:"border border-green-500 p-6 bg-black shadow-[0_0_10px_rgba(0,255,0,0.3)] ".concat(n),children:t})}function l(e){let{children:t,level:n=2,className:s=""}=e,l="h".concat(n);return(0,r.jsx)(l,{className:"".concat("text-green-500 font-mono"," ").concat({1:"text-2xl md:text-3xl",2:"text-xl",3:"text-lg"}[n]," ").concat(s),children:t})}function a(e){let{children:t,onClick:n,disabled:s=!1,variant:l="primary",className:a="",type:o="button"}=e;return(0,r.jsx)("button",{type:o,onClick:n,disabled:s,className:"".concat("border border-green-500 px-4 py-3 font-mono transition-colors disabled:opacity-50 disabled:cursor-not-allowed"," ").concat({primary:"text-green-500 hover:bg-green-500 hover:text-black",secondary:"text-green-500/70 hover:bg-green-500/20 hover:text-green-400"}[l]," ").concat(a),children:t})}function o(e){let{label:t,value:n,onChange:s,disabled:l=!1,placeholder:a="",type:o="text",className:i=""}=e,c="w-full bg-black border border-green-500 text-green-500 px-3 py-2 font-mono focus:outline-none focus:ring-1 focus:ring-green-500 disabled:opacity-50";return(0,r.jsxs)("div",{className:i,children:[(0,r.jsx)("label",{className:"block text-green-500 font-mono text-sm mb-1",children:t}),"textarea"===o?(0,r.jsx)("textarea",{value:n,onChange:e=>s(e.target.value),disabled:l,placeholder:a,className:"".concat(c," min-h-[100px] text-xs")}):(0,r.jsx)("input",{type:"text",value:n,onChange:e=>s(e.target.value),disabled:l,placeholder:a,className:c})]})}function i(e){let{label:t,checked:n,onChange:s,disabled:l=!1,className:a=""}=e,o="checkbox-".concat(t.toLowerCase().replace(/\s+/g,"-"));return(0,r.jsxs)("div",{className:"flex items-center space-x-2 ".concat(a),children:[(0,r.jsx)("input",{type:"checkbox",id:o,checked:n,onChange:e=>s(e.target.checked),disabled:l,className:"w-4 h-4 bg-black border border-green-500 text-green-500 focus:ring-1 focus:ring-green-500 disabled:opacity-50"}),(0,r.jsx)("label",{htmlFor:o,className:"text-green-500 font-mono text-sm",children:t})]})}var c=n(7653),d=n(9811);function x(){let[e,t]=(0,c.useState)("checking");return(0,c.useEffect)(()=>{let e=async()=>{let e=await (0,d.q)();t(e?"online":"offline")};e();let n=setInterval(e,5e3);return()=>clearInterval(n)},[]),(0,r.jsxs)("div",{className:"text-green-500 font-mono text-sm mb-2",children:["checking"===e&&"[BACKEND: CHECKING...]","online"===e&&"[BACKEND: ONLINE]","offline"===e&&(0,r.jsx)("span",{className:"text-red-500",children:"[BACKEND: OFFLINE]"})]})}},9811:function(e,t,n){"use strict";n.d(t,{j:function(){return a},q:function(){return l}});var r=n(4850);let s=r.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:4000";async function l(){try{let e=await fetch("".concat(s,"/api/workflow/ping"),{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok)return!1;let t=await e.json();return"ok"===t.status}catch(e){return console.error("Ping failed:",e),!1}}async function a(e,t){let n=await fetch("".concat(s,"/api/workflow/run-step"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({step:e,params:t})});if(!n.ok){let e=await n.text();throw Error("API request failed: ".concat(n.status," ").concat(n.statusText).concat(e?" - "+e:""))}return n.json()}}},function(e){e.O(0,[833,293,858,744],function(){return e(e.s=8030)}),_N_E=e.O()}]);